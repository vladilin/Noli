[gd_scene load_steps=11 format=3 uid="uid://cbh26n8hy8ks5"]

[ext_resource type="Texture2D" uid="uid://bvvx0kbx2pwbm" path="res://sprites/BACKGROUND.png" id="1_2gn6w"]
[ext_resource type="Script" uid="uid://bw7nawv5r1mn7" path="res://index.gd" id="1_ir7so"]
[ext_resource type="Theme" uid="uid://bu4xhjy2de5lw" path="res://styles/new1.0.tres" id="2_3bfj3"]
[ext_resource type="Script" uid="uid://cgmpk3cl1l8aw" path="res://time/time_system.gd" id="6_2fy20"]
[ext_resource type="Script" uid="uid://bom0tjxh2xywl" path="res://patient_manager_b.gd" id="7_2fy20"]
[ext_resource type="Script" uid="uid://b1vsapuleqnq3" path="res://time/date_time.gd" id="7_mvkpm"]
[ext_resource type="PackedScene" uid="uid://ck2c58key4r5s" path="res://time_ui.tscn" id="8_mvkpm"]

[sub_resource type="GDScript" id="GDScript_ir7so"]

[sub_resource type="Resource" id="Resource_2fy20"]
script = ExtResource("7_mvkpm")
seconds = 0
minutes = 0
hours = 12
days = 1
metadata/_custom_type_script = "uid://b1vsapuleqnq3"

[sub_resource type="GDScript" id="GDScript_d1yoc"]
script/source = "extends Node
class_name PatientManagerA

var patients: Array[Patient] = []

func _ready():
	load_patients_from_csv()

func load_patients_from_csv() -> void:
	var records = load(\"res://CSV/CS1.csv\").records
	for row in records:
		patients.append(Patient.new(
			row[\"Name\"],         # <-- Must match CSV header
			row[\"Abbr\"],
			row[\"Disease\"],
			row[\"TEXT\"],
			int(row[\"AGE\"]),
			row[\"SEX\"],
			int(row[\"HR\"]),
			row[\"BP\"],
			float(row[\"SPO2\"]),
			int(row[\"RESP\"]),
			float(row[\"Temp\"])
		))
	print(\"Loaded %d patients from CSV!\" % patients.size())
"

[node name="game_ui" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_ir7so")

[node name="bg_green" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.12549, 0.313726, 0.203922, 1)

[node name="bg_image" type="TextureRect" parent="bg_green"]
layout_mode = 0
offset_right = 1536.0
offset_bottom = 1024.0
theme = ExtResource("2_3bfj3")
texture = ExtResource("1_2gn6w")

[node name="Pt_profile" type="Panel" parent="bg_green"]
layout_mode = 0
offset_left = 275.0
offset_top = 31.0
offset_right = 315.0
offset_bottom = 71.0

[node name="pt_list" type="VBoxContainer" parent="bg_green"]
z_index = 5
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 27.0
offset_top = 31.0
offset_right = -1272.0
offset_bottom = -51.0
grow_horizontal = 2
grow_vertical = 2

[node name="Main_Buttons" type="VBoxContainer" parent="bg_green"]
layout_mode = 0
offset_left = 879.0
offset_top = 50.0
offset_right = 1136.0
offset_bottom = 987.0
script = SubResource("GDScript_ir7so")

[node name="wait" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "wait"

[node name="test" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "test"

[node name="treat" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "treat"

[node name="help" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "help"

[node name="dx" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "dx"

[node name="present" type="Button" parent="bg_green/Main_Buttons"]
layout_mode = 2
text = "pres"

[node name="TimeSystem" type="Node" parent="."]
script = ExtResource("6_2fy20")
date_time = SubResource("Resource_2fy20")
metadata/_custom_type_script = "uid://cgmpk3cl1l8aw"

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="timeGUI" parent="CanvasLayer" instance=ExtResource("8_mvkpm")]
offset_left = 603.0
offset_top = 33.0
offset_right = -811.0
offset_bottom = -782.0
scale = Vector2(2.09201, 2.069)

[node name="PatientManager" type="Node" parent="."]
script = SubResource("GDScript_d1yoc")

[node name="PatientManagerB" type="Node" parent="."]
script = ExtResource("7_2fy20")

[node name="HTTPRequest" type="HTTPRequest" parent="PatientManagerB"]

[connection signal="updated" from="TimeSystem" to="CanvasLayer/timeGUI" method="_on_time_system_updated"]
[connection signal="request_completed" from="PatientManagerB/HTTPRequest" to="PatientManagerB" method="_on_http_request_request_completed"]
